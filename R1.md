
## Log of Round 1 of #100DaysOfCode - done in 2020

### Day 1: 07/09/2020 - Monday

**Today's Progress:** Worked on the RSAT. Trying to use PSCustomObjects to store information of registry keys (Path,Value,Name,Type, etc..).

**Thoughts:** `Try/Catch` blocks are good for error handling you get when (for example) trying to retrieve info about an non-existing registry key, but you must be careful with Terminating vs Non-Terminating errors. `Get-ItemProperty` does not return a terminating error, which means the **Catch** portion will be skipped.

This can be fixed by adding the parameter `-ErrorAction Stop` which changes it to a terminating error, making the catch block work.

**Link to work:** [RSAT](https://github.com/TimekillerTK/RSAT/commit/f212ba8211d5cda361194e9d1ce2768347e9378d)

### Day 2: 08/09/2020 - Tuesday

**Today's Progress:** Continued work on RSAT. Used objects successfully to store values and properties of certain registry keys. Still need to finish clean up at the end of the script and it should be working.

**Thoughts:** The `Try/Catch` blocks that are in my script are awful, but they work! Way too much redundancy - they need to be changed into a single function as they're very prone to typos. Will fix that later after the dev branch is functioning exactly as expected!

I also had a harsh lesson in `=` vs `-eq`. Only the latter will compare, the former will actually set the value. Had me puzzled for a while when I had `$_.Changed = $true` in an if statement that always ran the if scriptblock, regardless of the actual value of `$_.Changed`

**Link to work:** [RSAT](https://github.com/TimekillerTK/RSAT/commit/4ba47cfa5f2b8b8798c68bd9a500789ef965e1a6)

### Day 3: 09/09/2020 - Wednesday

**Today's Progress:** Finished RSAT by completing the final block. Script now remembers what registry values were before script run. It's now fully functional under Powershell 7. 

**Thoughts:** Most of my time was spent testing the script, rather than coding - had some strange behavior because of faulty logic. Script will need to work under 5.1 for convenience - it shouldn't be too much work to refactor the code. Planning to do that tomorrow.

Still a few things left to be done:
- `Try/Catch` blocks still awful, need to be changed to single function.
- Should be working under Powershell 5.1 as well - currently it isn't
- Dev branch should be merged to the master branch

**Link to work:** [RSAT](https://github.com/TimekillerTK/RSAT/commit/a36ba360d40c762fb5471699636522c79402aa32)

### Day 4: 10/09/2020 - Thursday

**Today's Progress:** Wrapped the `Try/Catch` blocks into a second function, merged into master. Then in the dev branch wrapped the second function into the first.

**Thoughts:** There's always a more efficient way to do things. After I wrote a function to remove the redundant `Try/Catch` blocks, I quickly realized that my two functions could actually be one function, and I spent the rest of my time merging the two. Was much easier than I thought.

The one thing left to do is to make it work with Powershell 5.1, which may take some work. Will see what I can do about it tomorrow!

**Link to work:** [RSAT-master](https://github.com/TimekillerTK/RSAT/commit/afc7b3ba050a50d6b0a5002ccd0171c674fa1806) [RSAT-dev](https://github.com/TimekillerTK/RSAT/commit/1ec0f5ea6284d49e9b09eb85c9da7ae3dd6f0bf8)

### Day 5: 11/09/2020 - Friday

**Today's Progress:** Fixed code to work under Windows Powershell 5.1! First release.

**Thoughts:** Felt a bit like I spent most of my time today running around in circles trying to find why there were errors generated when running the code under Powershell 5.1 when the code was working fine under Powershell 7. 

The errors were all caused by a [bug in VS Code](https://github.com/microsoft/vscode/issues/102103). It was caused by the BOM in UTF-8 being doubled in the current version of VS Code. To fix, I needed to update VS Code, create a new file and copy/paste the code.

**Link to work:** [RSAT](https://github.com/TimekillerTK/RSAT/commit/df21ff09323abc367946de4fb69235557d894d51)

### Day 6: 12/09/2020 - Saturday

**Today's Progress:** New project, bit of research into writing functions properly from: https://docs.microsoft.com/en-us/powershell/scripting/learn/ps101/09-functions?view=powershell-7

**Thoughts:** Should really focus on getting my hour of coding done in the early morning, as later during the afternoon I have less motivation and more distractions.

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/bd957a746be61ea42ce7eb4c77337297048e3793)

### Day 7: 13/09/2020 - Sunday

**Today's Progress:** First working version of `Get-TVEpList`!

**Thoughts:** Took a long time to find a way to get this working properly. Method isn't perfect, but it's working. I learned today that `ConvertFrom-String` uses a sort of machine learning algorithm to match strings to the specified template: https://devblogs.microsoft.com/powershell/convertfrom-string-example-based-text-parsing/ 

Much easier than fishing for the correct regex patterns, but I also learned that it works differently depending on powershell version. Will finish up on this cmdlet tomorrow, and start on a new one, if I have the time.

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/171ce48ca10f83196b19afd58027bb89d166848e)

### Day 8: 14/09/2020 - Monday

**Today's Progress:** Fixed Get-TVEpList help, updated it. Added additional parameters `-Regex` and `-RemoveIllegalChars`

**Thoughts:** Getting really comfortable with `for`, `foreach` and `ForEach-Object` loops. They really are the core of Powershell automation. The next step is going to be the cmdlet that will accept either objects from `Get-TVEpList` or a CSV file. Will need to give it a think on what exactly those cmdlets will be supposed to do.

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/7485734440be380cda30ce434dd87fb36aa84b7b)

### Day 9: 15/09/2020 - Tuesday

**Today's Progress:** Used lessons from the book Powershell Scripting in a Month of Lunches to change `Get-TVEpList`. Created first step in next project `gsuite-automation2`

**Thoughts:** Read a very illuminating chapter in the book Powershell Scripting in a Month of Lunches. Firstly I learned about `$PSBoundParameters` which contains information about the parameters passed to a cmdlet. This allows you to check whether a parameter was used or not with `$PSBoundParameters.ContainsKey('Parameter')`, for example, and use that in a conditional!

As time goes on I keep realizing that my script can work differently / more efficiently. I added support for passing multiple URIs (because why not?). And I think another parameter for searching via string rather than just URI might be a good thing to do down the line!

Started work on a second project so I can bounce between the two.

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/46d6c36719b256f41c1ac64e95a90b76a5732210), [gsuite-automation2](https://github.com/TimekillerTK/gsuite-automation2/commit/081f329b0a058c656836afc8e0bffc998128ef64)

### Day 10: 16/09/2020 - Wednesday

**Today's Progress:** Not very much, started work on `Format-TVEpInfo`. 

**Thoughts:** Today I learned how important it is to have a design document for your code. I thought I had the whole pipleine for `Get-TVEpList` and `Format-TVEpInfo` figured out, but it turns out that what I had in mind was much harder to put into code than anticipated.

I also ended up stuck at the very beginning in the `param` block - the `-InputObject` was set as an array of `string[]`. Doing this completely invalidated everything that `Get-TVEpList` did by just turning the nicely organized objects into simple strings. After fixing this by changing the parameter to `PSCustomObject`, everything started working.

In the end I had to scrap what I was doing and start over. I spent some time at work today planning out the code I was going to do tomorrow morning. Should be a lot more productive.

**Link to work:** [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commits/master/Format-TVEpInfo.ps1)

### Day 11: 17/09/2020 - Thursday

**Today's Progress:** First working version of `Format-TVEpInfo`. Used a switch statement for the very first time.

**Thoughts:** If you plan properly, coding becomes a breeze. While coding I discovered how complicated turning integers into roman numerals is. This might be a side project on its own.

I removed the `-RemoveIllegalChar` parameter from `Get-TVEpList` and moved it to `Format-TVEpInfo`. Makes much more sense for that parameter to be there. 

Need to do some more planning for tomorrow, as I'm not sure how to approach the roman numerals yet. Also need to consider how and where to implement the switch statement.

**Link to work:** [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commit/663e8ff590945838afe84946dc814a4f614ac2ec) [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/f63d0a9102c562c44e70fd790d33c1c591792b71)

### Day 12: 18/09/2020 - Friday

**Today's Progress:** Removed switch function from `Format-TVEpInfo` and added it to `Get-TVEpList`. It now works and adds a `EpisodeZeroed` property. 

**Thoughts:** The intention behind my code was to add leading zeroes to episodes in `Format-TVEpInfo`. The problem was that in order to know how many leading zeroes there should be, you need to know how many episodes there will be. To illustrate the problem, imagine a show season with 24 episodes, this means the goal would be episode numbers like so:
* `01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24`

This means that **ONLY** for numbers between 1-9, we need to add a leading zero, the rest of the numbers should stay untouched. But what if a season has over a hundred episodes? You'll need to add two leading zeroes to episodes 1-9 and then one leading zero to episodes 10-99.

The more you think about it, the more you can see that implementing this function in `Format-TVEpInfo` would not be possible. `Format-TVEpInfo` is designed to accept pipeline input, so the function doesn't know, or doesn't care how many objects are going to be fed to it in the pipeline.

Therefore, I added a new attribute for objects within `Get-TVEpList` called `EpisodeZeroed`, which stores it as a string rather than an integer.

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/1b30efa0f93ad7b723425b1756f0c996a9be52f2) [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commit/0a7e2df4beb7108ec3ef45109fb7ccc45111edf4)

### Day 13: 19/09/2020 - Saturday

**Today's Progress:** Not much. Did mostly some thinking / planning around implementing roman numerals in `Format-TVEpInfo`

**Thoughts:** I haven't looked into math much in my programming journey yet, and solving the problem of changing numers into roman numerals isn't an easy one. It requires careful planning and thinking. For now, I managed to find a key method in implementing this into code, which I didn't manage to do due to lack of time. 

For a given number like `26` (which is `XXVI` in roman), you can use division and modulus Arithmetic operators to find the right roman numerals. For example:
* How many times does 10 fit in `26`? 
  * `[System.Math]::Floor(26 / 10) = 2`
  * `26 % 10 = 6`
* How many times does 5 fit in `6`?
  * `[System.Math]::Floor(6 / 5) = 1`
  * `6 % 5 = 1`
* How many times does 1 fit in `1`?
  * `1 / 1 = 1`

This allows you to construct the basics. This of course doesn't account for numbers such as 4 (IV) and 9 (IX), but this is a good first step.

**Link to work:** [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commit/edd3a5246c395426320807b21e0131f543201281)

### Day 14: 20/09/2020 - Sunday

**Today's Progress:** Finished a working function for roman numerals. 

**Thoughts:** First working version of the roman numerals function. Just need to integrate it properly, because it's currently not working. Once that's done, I'll need to do a final test to see if the entire pipeline is working as intended.

I'll also spend some time tomorrow on optimizing code / writing help.

**Link to work:** [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commit/1f6d1238abb6254b79daebce994e394360f95ed7)

### Day 15: 21/09/2020 - Monday

**Today's Progress:** Properly integrated roman numerals function. All features implemented.

**Thoughts:** Now the only thing that remains is to polish both cmdlets and use them in controller scripts. There might still be need to use a 3rd cmdlet for file renaming and categorizing into the correct single folder, but I'll try to use a controller script first.

**Link to work:** [Format-TVEpInfo](https://github.com/TimekillerTK/Format-TVEpInfo/commit/c68e86662a91163fb483ecbfad7b52994f404ef0)

### Day 16: 22/09/2020 - Tuesday

**Today's Progress:** Refactored code for `Get-TVEpList`

**Thoughts:** Not much progress today, I mostly worked on refactoring code for `Get-TVEpList` as the existing switch & if statements were horribly suboptimal. I found the perfect thing to replace them `String.PadLeft`, which does exactly what I wanted - adding characters to the left of the string. 

This allowed me to replace 20+ lines of code with just 3. Amazing!

**Link to work:** [Get-TVEpList](https://github.com/TimekillerTK/Get-TVEpList/commit/74eac0dc484b6a38468998a58d9d6ff1eed18c6f)

### Day 17: 23/09/2020 - Wednesday

**Today's Progress:** Created a working function to combine two lists of objects in `gsuite-automation2`

**Thoughts:** I spent a long time today just thinking how this is supposed to work. For the purpose of this project I decided that it would be a good idea to retrieve a list of users in Active Directory who belong to a specific AD group, then retrieve a list of GSuite users. Using the `mail` attribute, the function should match the ADUser to the GSuite user and create a new object that has all the properties of both.

At the very end, any remaining objects that don't have a match, should be added to the list of objects, just with missing properties.

Visualizing how this would work was difficult for me in my mind, so I had to go back to basics, draw two imaginary lists of objects with a single property that is identical for both lists for a particular object. This helped me reach the eventual final code, which works.

What remains to do is to actually integrate what I wrote into my existing code, because it's still using imaginary properties, variables and objects.

**Link to work:** [gsuite-automation2](https://github.com/TimekillerTK/gsuite-automation2/commit/c1423bb84cff9b5254d1b826d797544632faaeb5)

### Day 18: 24/09/2020 - Thursday

**Today's Progress:** Integrated changes into `gsuite-automation2`

**Thoughts:** I spent some time today in the morning to integrate the changes from yesterday into the code, however - I forgot to commit... What's still left to be done is to finalize the AD query, as that is the only thing holding the function back from getting the information it needs.

**Link to work:** MISSING BECAUSE I FORGOT TO COMMIT MY CHANGES 

### Day 19: 25/09/2020 - Friday

**Today's Progress:** Finished first cmdlet `Get-MatchingUsers`

**Thoughts:** Implemented all the working bells and whistles for this cmdlet. Still rough and could use improvements, but enough for now. The next step is to actually add logging and add users based on this information.

**Link to work:** [Get-MatchingUsers](https://github.com/TimekillerTK/gsuite-automation2/commit/ee2d95171700a31ec09589e54cf1d1873c32017a)

### Day 20: 26/09/2020 - Saturday

**Today's Progress:** Added logging and SMTP functions

**Thoughts:** Not much done today.. Added SMTP and logging functions. Standalone at the moment, but fully functional. 

**Link to work:** [Get-MatchingUsers](https://github.com/TimekillerTK/gsuite-automation2/commit/0bc9a8db3cbea75314d9bf586a198d4be50d65c8)

### Day 21: 27/09/2020 - Sunday

**Today's Progress:** Added `logs` folder to project which will be used for storing logs

**Thoughts:** Also added `.gitignore` file. For the logging function to work properly, I need to understand how `$MyInvocation` works. This is an automatic variable which stores the path for where the script is executed. This is useful if you always want logs to be placed in the same folder (which I do).

For now, it's not working. I'll investigate tomorrow.

**Link to work:** [Get-MatchingUsers](https://github.com/TimekillerTK/gsuite-automation2/commit/999a9ad113e14a29c10cff1c1a68b5aa9c2a3817#diff-3e211a2b50de36191b0e1f4f354ebf4a)

### Day 22: 28/09/2020 - Monday

**Today's Progress:** Learned about splatting, inserted it into the code.

**Thoughts:** Refined logging a bit, but I found myself in a situation where a new logfile gets created every second because of the way I use logging. I have an idea for a workaround to the `LogWrite` function, where I would set a variable at the beginning of the script, outside of the function. Another possibility is the `Get-History` cmdlet, which has `StartExecutionTime` property, which can be used here.

**Link to work:** [Get-MatchingUsers](https://github.com/TimekillerTK/gsuite-automation2/commit/bcc2e5dee21ac9ba2057afc726e5169bbb1f3421)

### Day 23: 29/09/2020 - Tuesday

**Today's Progress:** Logging function fully working and integrated into the code.

**Thoughts:** Turned out yesterdays thoughts on how to fix the `LogWrite` function were incorrect. I decided on a different, sub-optimal approach where I set a variable with the current date at the beginning of the `PROCESS` block, this is then used as a timestamp that the `LogWrite` function takes through the `-Time` parameter. 

I realized that my progress has been a bit at a standstill recently due to trying to find a 'perfect' way to do things. There's always time for refinement and improvement later. For now, what's important is working code! 

Hopefully tomorrow I can begin the controller script which will create users that do not exist in GSuite yet.

**Link to work:** [LogWrite](https://github.com/TimekillerTK/gsuite-automation2/commit/07d8e2f4e04c109a6e03ee2bb0c03a42da6e0941)

### Day 24: 30/09/2020 - Wednesday

**Today's Progress:** Created controller script (incomplete), created module manifest file, updated `SendMail` function

**Thoughts:** It's killing me, but I'm banging out imperfect, ugly code, obviously evident in the `Controller.ps1` file. But the pace is much faster for the progress of the script! Eventually, I'll need to move some of the actions within the controller script into the module itself, but for now it'll suffice.

**Link to work:** [Controller, GSuiteAutomation](https://github.com/TimekillerTK/gsuite-automation2/commit/4b483216a1380408351bd34c48cd2a394b3373f6)

### Day 25: 01/10/2020 - Thursday

**Today's Progress:** Continued work on controller script, tightened functionality of `SendMail` function.

**Thoughts:** Just continued work, not much to say. 

**Link to work:** [Controller, GSuiteAutomation](https://github.com/TimekillerTK/gsuite-automation2/commit/1e7c091b5d2f53e558cda9843aeacf52db7f5e10)

### Day 26: 02/10/2020 - Friday

**Today's Progress:** Continued work on everything, fully working version without errors, but incomplete.

**Thoughts:** Continued onwards since yesterday and made a bunch of adjustments. I did need to spend a little time to read about `$MyInvocation` and all the wonderful ways in which it works. It turns out that depending on the situation, you might want to use `$PSScriptroot`, `$MyInvocation.MyCommand.Path` or `$MyInvocation.PSScriptRoot` (which I used) for the purpose of capturing the folder in which your script resides. I wrote up a little documentation for myself to remember for the future, because I think I'll be using this sometime later. 

For now, what remains to be done is to tidy up logging a bit, and then start moving some chunks of code from the controller script into the script module. At this point I'll spin off a `dev` branch since I have a working version of the code.

**Link to work:** [Controller, GSuiteAutomation](https://github.com/TimekillerTK/gsuite-automation2/commit/abd7663106621ed6a39b98e453302c12dadfb1bc)

### Day 27: 03/10/2020 - Saturday

**Today's Progress:** Just updated README.

**Thoughts:** Not much done today, updated README for the project, which was blank until now. I my first issue with corrupted files in the `.git` directory. Was quite scary initially, where I couldn't commit my changes. 

This turned out to be caused by OneDrive. 

I have all of my git projects within a single directory `C:\git`. Since I'm working on a powershell module, for convenience I wanted the project files in one of the directories in `$env:PSModulePath`. To faciliate this setup, I moved the project to within the `..\OneDrive\Documents\Powershell\Module` directory and created a symlink to it within `C:\git`. 

Good lesson for the future, avoid puttng repos in cloud-sync'ed directories.

**Link to work:** [README for GSuiteAutomation](https://github.com/TimekillerTK/gsuite-automation2/commit/289a290568e1aad63c5ef502e36afd8c46eebd95)

### Day 28: 04/10/2020 - Sunday

**Today's Progress:** Mostly thinking about next steps.

**Thoughts:** Just realized that the script is actually feature complete as it is. There are still many adjustments that can be done, especially the part where the input happens with `.csv` files in a specific directory - that can certainly be tweaked is the amount of code in the controller script itself.

The logic which extracts info about 'new' users which need to be created should be something `Get-MatchingUsers` outputs by itself by a switch in the parameters. Should probably be a selection of: `All`,`GSDiff`, `ADDiff` with a verbose message saying it's empty, if that's the case.

The values output should match those of what `New-GSUser` would use. I'll make a modification then, if working, deploy the code in prod.

**Link to work:** No link, just planning.

### Day 29: 05/10/2020 - Monday

**Today's Progress:** Worked for quite a bit of hours today. Mostly code refactoring on `Get-MatchingUsers`

**Thoughts:** First off, I updated the parameters for `Get-MatchingUsers` for some sensible defaults, also added the `-Scope` parameter, of which values are interpreted by a new `switch` statement. This switch allows the selection of specific subsets of data - more user friendly this way.

Also created a new function called `OutputObject` which is something that a class based on which new objects get created as they get processed within the `foreach` loops. This doesn't reduce the amount of code quite as much as I had hoped, but gives me ideas on how I can create more functions to make the `switch` options not seem as bloated. 

Work is unfinished tonight, and code in the `dev` branch is not in a working state. Need to resume tomorrow to fix the output and then make sure all the conditions return the correct values.

**Link to work:** [gsuite-automation2](https://github.com/TimekillerTK/gsuite-automation2/commit/cbeb6c3a2bd2fe816459ebe50075eb6d53ed371f)

### Day 30: 06/10/2020 - Tuesday

**Today's Progress:** Wrote a new function `FixLastName` to get rid of redundant code. Dev branch code is in working state again.

**Thoughts:** Got stuck today on the `FixLastName` function. It kind of works and does what it's supposed to, but unfortunately it's buggy. Regex matching works perfectly, however the way it's written now doesn't account for any items which have no regex match whatsoever.

I did get a tip on how to solve this issue - adding a bool value to tell me if I matched any regex values in the set. I'll try that first thing tomorrow.

**Link to work:** [gsuite-automation2](https://github.com/TimekillerTK/gsuite-automation2/commit/8a4fe93351bfa9f55f6cfa44da8aa4e2d397a0d0)

### Day 31: 07/10/2020 - Wednesday

**Today's Progress:** `GSuiteAutomation` into working code, `FixLastName` function fully implemented.

**Thoughts:** Merged all the work in dev into master. Made many adjustments throughout the day to make sure everything is in working order.

The `FixLastName` function was fixed, and it turned out I just needed an additional variable `$setvalue` to set/read a state which, when triggered by an if statement, returns the value of `$lastname`.

What's left to do? A lot actually, there are major sections of the code that I want to change or optimize, but it works!

The README also needs to be updated with information on how to use it (in a way that is easy to understand)

**Link to work:** [gsuiteautomation](https://github.com/TimekillerTK/gsuite-automation2/commit/a9331384a88fcfd48d54e5b418d41a8801366a2d)

### Day 32: 08/10/2020 - Thursday

**Today's Progress:** Updated README, updated HELP for `Get-MatchingUsers`, fixed missing E-mail subject in the Controller Script.

**Thoughts:** Learned how Powershell debugging works today. It sadly wasn't too useful during my coding today, because I couldn't get it to work with the Controller script. I need to do more reading into the subject.

**Link to work:** [gsuiteautomation](https://github.com/TimekillerTK/gsuite-automation2/commit/4eb916d62c3c01e7a6ffb4dbd7dec94a1b16df02)